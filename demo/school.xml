<?xml version="1.0" encoding="utf-8"?>
<script>

  <!-- Applied to all procedures -->
  <global logfile="school.log" language="English UpperCase">
    <event name="OpenWindow">

      <!-- Property changes for all lists in the app -->
      <action name="SetProp" type="list">
        <!-- Set LineHeight to 16 -->
        <property name="lineheight" value="16"></property>
        
        <!-- Assign Export hot keys -->
        <property name="Alrt" value="CtrlShiftE"></property>
        <property name="Alrt" value="CtrlShiftH"></property>
        <property name="Alrt" value="CtrlShiftS"></property>
      </action>

      <!-- Set Flat for all buttons -->
      <action name="SetProp" type="button">
        <property name="flat" value="1"></property>
      </action>
      
      <!-- Hot key Ctrl-Shift-P to capture windows -->
      <action name="SetProp">
        <property name="Alrt" value="CtrlShiftP"></property>
      </action>
    
      <!-- Assign hot keys to each list in the app -->
      <action name="SetProp" type="list">
      </action>
    </event>
    
    <!-- Capture each window -->
    <event name="alertkey" key="CtrlShiftP">
      <!--<action name="Capture" expression="capture.bmp"/>-->
      <action name="Capture"/>  <!-- autogenerated file name: "procedure_date_time.bmp" -->
    </event>

    <!-- Export each list in the app -->
    <event name="alertkey" field="?" key="CtrlShiftE">
      <action name="Export" expression="Excel"></action>
    </event>
    <event name="alertkey" field="?" key="CtrlShiftH">
      <action name="Export" expression="Html"></action>
    </event>
    <event name="alertkey" field="?" key="CtrlShiftS">
      <action name="Export"></action>
    </event>
  
  </global>
  
  <!-- Procedure "Main" -->
  <procedure name="Main">

    <!-- A two-column drop menu -->
    <event name="beforeacceptloop" position="1">
      <action name="SetProp" field="?BrowseEnrollment">
        <property name="Max" value="1"/>
      </action>
    </event>
    
    <!-- Initialize window and controls -->
    <event name="OpenWindow">

      <!-- Globally disable tooltips -->
      <action name="SetProp" field="System">
        <property name="notips" value="1"></property>
      </action>
      
      <!-- Change APPLICATION title -->
      <action name="ChangeText" expression="'School with ScriptPlayer [Current path: ' &amp; PATH() &amp; ']'"  evaluate="1"/>
      
      <!-- Open BrowseStudents() procedure -->
      <action name="Accept" field="?BrowseStudents"/>
    </event>
    
    <!-- Say "Bye-bye" on closing -->
    <event name="CloseWindow">
      <action name="Evaluate" expression="MESSAGE('Bye-bye!', 'Script Player', 'ICON:Application')"/>
      <!--<action name="Evaluate" expression="MESSAGE('Bye-bye!', 'Script Player', 'CLOSED.ICO')"/>-->
    </event>
  
  </procedure>
  
  <!-- Procedure "BrowseStudents" -->
  <procedure name="BrowseStudents">
    
    <!-- Initialize window and controls -->
    <event name="OpenWindow" position="1">
      
      <!-- Change font style to Bold for ?Close button -->
      <action name="SetProp" field="?Close">
        <property name="fontstyle" value="700"></property>
      </action>
      
      <!-- Select 2nd TAB -->
      <action name="SetProp" field="?CurrentTab">
        <property name="selected" value="2"></property>
      </action>
    
      <action name="SetProp" field="?Browse:1">
        <!-- Change header colors -->
        <property name="list:DefHdrTextColor" color="White"/>
        <property name="list:DefHdrBackColor" color="Black"/>
        
        <!-- Change style for all columns -->
        <property name="style:fontname" index="1" value="Tahoma"/>
        <property name="style:fontsize" index="1" value="12"/>
        <property name="style:textcolor" index="1" color="Red"/>
        <property name="style:backcolor" index="1" color="Black"/>
        <property name="style:textselected" index="1" color="Yellow"/>
        <property name="style:backselected" index="1" color="Gray"/>
      
        <property name="list:ColStyle" index="1" value="1"/>
        <property name="list:ColStyle" index="2" value="1"/>
        <property name="list:ColStyle" index="3" value="1"/>
        <property name="list:ColStyle" index="4" value="1"/>
        <property name="list:ColStyle" index="5" value="1"/>
        <property name="list:ColStyle" index="6" value="1"/>
        <property name="list:ColStyle" index="7" value="1"/>
        <property name="list:ColStyle" index="8" value="1"/>
        <property name="list:ColStyle" index="9" value="1"/>
        <property name="list:ColStyle" index="10" value="1"/>
        <property name="list:ColStyle" index="11" value="1"/>
      </action>

      <!-- Inform a user about hotkeys -->
      <action name="Evaluate" expression="MESSAGE('Press Ctrl-Shift-E to export to Excel|Press Ctrl-Shift-H to export to HTML|Press Ctrl-Shift-S to open a dialog|while browse box has focus.', 'Script Player', 'ICON:Asterisk')">
      </action>

      <!-- TEST CALL(HIDE) -->
      <action name="Call" function="HIDE">
        <parameter value="?Help"></parameter>
      </action>
    </event>
  </procedure>

  <!-- Localization -->
  <language name="English UpperCase">
    <!-- File menu -->
    <procedure name="Main">
      <field name="?MENU1">&amp;FILE</field>
      <field name="?PrintSetup">&amp;PRINT SETUP ...</field>
      <field name="?Exit">E&amp;XIT</field>
      <!-- Edit menu -->
      <field name="?MENU2">&amp;EDIT</field>
      <field name="?Cut">CU&amp;T</field>
      <field name="?Copy">&amp;COPY</field>
      <field name="?Paste">&amp;PASTE</field>
      <!-- Trees menu -->
      <field name="?Trees">&amp;TREES</field>
      <field name="?BrowseClassTree">&amp;CLASS TREE</field>
      <field name="?BrowseStudentsTree">&amp;STUDENTS TREE</field>
      <!-- Browse menu -->
      <field name="?MENU3">&amp;BROWSE</field>
      <field name="?BrowseStudents">STUDENTS</field>
      <field name="?BrowseTeachers">TEACHERS</field>
      <field name="?BrowseClasses">CLASSES</field>
      <field name="?BrowseEnrollment">ENROLLMENT</field>
      <field name="?BrowseCourses">COURSES</field>
      <field name="?BrowseMajors">MAJORS</field>
      <field name="?BrowseUpdateGrades">UPDATE GRADES</field>
      <!-- Reports cmenu -->
      <field name="?ReportMenu">&amp;REPORTS</field>
      <field name="?PrintENR:StuSeq">STUDENT CLASS SCHEDULES</field>
      <field name="?ReportsTeacherClassSchedules">TEACHER CLASS SCHEDULES</field>
      <field name="?PrintENR:SeqStu">ATTENDANCE SHEETS</field>
      <field name="?PrintCOU:KeyDescription">COURSE ENROLLMENT</field>
      <field name="?ReportsCourseEnrollmentSummary">COURSE ENROLLMENT SUMMARY</field>
      <field name="?ReportsFinalGrades">FINAL GRADES</field>
      <field name="?ReportsStudentIDs">STUDENT IDS</field>
      <!-- Window menu -->
      <field name="?MENU4">&amp;WINDOW</field>
      <field name="?Tile">T&amp;ILE</field>
      <field name="?Cascade">&amp;CASCADE</field>
      <field name="?Arrange">&amp;ARRANGE ICONS</field>
      <!-- Help menu -->
      <field name="?MENU5">&amp;HELP</field>
      <field name="?Helpindex">&amp;CONTENTS</field>
      <field name="?HelpSearch">&amp;SEARCH FOR HELP ON...</field>
      <field name="?HelpOnHelp">&amp;HOW TO USE HELP</field>
    </procedure>
  </language>
</script>