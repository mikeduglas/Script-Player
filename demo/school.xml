<?xml version="1.0" encoding="utf-8"?>
<script>

  <!-- Applied to all procedures -->
  <global logfile="school.log">
    <event name="OpenWindow" position="1">
      
      <!-- Set LineHeight to 16 for all listboxes -->
      <action name="SetProp" type="list">
        <property name="lineheight" value="16"></property>
      </action>
    </event>
  </global>
  
  <!-- Procedure "Main" -->
  <procedure name="Main">

    <!-- Initialize window and controls -->
    <event name="OpenWindow" position="1">

      <!-- Globally disable tooltips -->
      <action name="SetProp" field="System">
        <property name="notips" value="1"></property>
      </action>
      
      <!-- Change APPLICATION title -->
      <action name="ChangeText" expression="'School with ScriptPlayer [Current path: ' &amp; PATH() &amp; ']'"  evaluate="1"/>

      <!-- Translate menu items from English to ENGLISH (all texts in UPPER CASE)-->
      
      <!-- File menu -->
      <action name="ChangeText" field="?MENU1" expression="&amp;FILE"/>
      <action name="ChangeText" field="?PrintSetup" expression="&amp;PRINT SETUP ..."/>
      <action name="ChangeText" field="?Exit" expression="E&amp;XIT"/>
      
      <!-- Edit menu -->
      <action name="ChangeText" field="?MENU2" expression="&amp;EDIT"/>
      <action name="ChangeText" field="?Cut" expression="CU&amp;T"/>
      <action name="ChangeText" field="?Copy" expression="&amp;COPY"/>
      <action name="ChangeText" field="?Paste" expression="&amp;PASTE"/>
      
      <!-- Trees menu -->
      <action name="ChangeText" field="?Trees" expression="&amp;TREES"/>
      <action name="ChangeText" field="?BrowseClassTree" expression="&amp;CLASS TREE"/>
      <action name="ChangeText" field="?BrowseStudentsTree" expression="&amp;STUDENTS TREE"/>
     
      <!-- Browse menu -->
      <action name="ChangeText" field="?MENU3" expression="&amp;BROWSE"/>
      <action name="ChangeText" field="?BrowseStudents" expression="STUDENTS"/>
      <action name="ChangeText" field="?BrowseTeachers" expression="TEACHERS"/>
      <action name="ChangeText" field="?BrowseClasses" expression="CLASSES"/>
      <action name="ChangeText" field="?BrowseEnrollment" expression="ENROLLMENT"/>
      <action name="ChangeText" field="?BrowseCourses" expression="COURSES"/>
      <action name="ChangeText" field="?BrowseMajors" expression="MAJORS"/>
      <action name="ChangeText" field="?BrowseUpdateGrades" expression="UPDATE GRADES"/>
     
      <!-- Reports cmenu -->
      <action name="ChangeText" field="?ReportMenu" expression="&amp;REPORTS"/>
      <action name="ChangeText" field="?PrintENR:StuSeq" expression="STUDENT CLASS SCHEDULES"/>
      <action name="ChangeText" field="?ReportsTeacherClassSchedules" expression="TEACHER CLASS SCHEDULES"/>
      <action name="ChangeText" field="?PrintENR:SeqStu" expression="ATTENDANCE SHEETS"/>
      <action name="ChangeText" field="?PrintCOU:KeyDescription" expression="COURSE ENROLLMENT"/>
      <action name="ChangeText" field="?ReportsCourseEnrollmentSummary" expression="COURSE ENROLLMENT SUMMARY"/>
      <action name="ChangeText" field="?ReportsFinalGrades" expression="FINAL GRADES"/>
      <action name="ChangeText" field="?ReportsStudentIDs" expression="STUDENT IDS"/>
     
      <!-- Window menu -->
      <action name="ChangeText" field="?MENU4" expression="&amp;WINDOW"/>
      <action name="ChangeText" field="?Tile" expression="T&amp;ILE"/>
      <action name="ChangeText" field="?Cascade" expression="&amp;CASCADE"/>
      <action name="ChangeText" field="?Arrange" expression="&amp;ARRANGE ICONS"/>
    
      <!-- Help menu -->
      <action name="ChangeText" field="?MENU5" expression="&amp;HELP"/>
      <action name="ChangeText" field="?Helpindex" expression="&amp;CONTENTS"/>
      <action name="ChangeText" field="?HelpSearch" expression="&amp;SEARCH FOR HELP ON..."/>
      <action name="ChangeText" field="?HelpOnHelp" expression="&amp;HOW TO USE HELP"/>

      
      <!-- Open BrowseStudents() procedure -->
      <action name="Accept" field="?BrowseStudents"/>
    
    </event>
    
    <!-- Say "Bye-bye" on closing -->
    <event name="CloseWindow">
      <action name="Evaluate" expression="MESSAGE('Bye-bye!', 'Script Player', 'ICON:Application')"/>
    </event>
  
  </procedure>
  
  <!-- Procedure "BrowseStudents" -->
  <procedure name="BrowseStudents" event="OpenWindow" action="Accept" target="?Insert:2">
    
    <!-- Inform a user about hotkeys -->
    <event name="OpenWindow">
      <action name="Evaluate" expression=
      "MESSAGE('Press Ctrl-Shift-E to export to Excel|Press Ctrl-Shift-H to export to HTML|Press Ctrl-Shift-S to open a dialog|while browse box has focus.', 'Script Player', 'ICON:Asterisk')"/>
    </event>
    
    <!-- Initialize window and controls -->
    <event name="OpenWindow" position="1">
      
      <!-- Change font style to Bold for ?Close button -->
      <action name="SetProp" field="?Close">
        <property name="fontstyle" value="700"></property>
      </action>
      
      <!-- Select 2nd TAB -->
      <action name="SetProp" field="?CurrentTab">
        <property name="selected" value="2"></property>
      </action>
    
      <!-- Assign hot keys to ?Browse:1 -->
      <action name="SetProp" field="?Browse:1">
        <property name="Alrt" value="CtrlShiftE"></property>
        <property name="Alrt" value="CtrlShiftH"></property>
        <property name="Alrt" value="CtrlShiftS"></property>
      </action>

    </event>
  
    <!-- Export ?Browse:1 contents -->
    <event name="alertkey" field="?Browse:1" key="CtrlShiftE">
      <action name="Export" field="?Browse:1" expression="Excel"></action>
    </event>
    <event name="alertkey" field="?Browse:1" key="CtrlShiftH">
      <action name="Export" field="?Browse:1" expression="Html"></action>
    </event>
    <event name="alertkey" field="?Browse:1" key="CtrlShiftS">
      <action name="Export" field="?Browse:1"></action>
    </event>
  </procedure>
</script>